# preprocessing
import keras
#from keras import LSTM

import operator
import pickle
import numpy as np

from gensim.models import Word2Vec

# fixed number of common words
v = 8000
vocab = pickle.load(open('../counts.pkl', 'r'))

counts = sorted(vocab.items(), key=operator.itemgetter(1))
common = counts[:8000]

model = Word2Vec.load('tweets.model')

l = len(model[common[0]])

U = np.zeros(l, v)

for j in range(v):
    vec = model[common[j]]
    
    for i in range(l):
        U[i][j] = vec[i]

pickle.dump(U, open('U.pkl', 'r'))
